!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).patch2dom=n()}(this,function(){"use strict";var t=Array.isArray,e=Object.getOwnPropertyNames,n=Array.prototype.slice,u=function(t,e){var r,o;"TEXTAREA"!==t.nodeName&&(r=f(t,e),o=t.firstChild,e.forEach(function(e){var n=typeof e;"string"==n||"number"==n?o=i(t,o,""+e):p(e)&&(o=c(t,o,r,e))}),a(t,r),l(t,e))},i=function(e,n,t){return n?3===n.nodeType?(n.nodeValue!==t&&(n.nodeValue=t),n=n.nextSibling):T(e,x(t),n):E(e,x(t)),n},c=function(e,n,t,r){var o=r.attrs.domkey,i=o?t[o]:null;if(i)delete t[o],s(i,r.attrs),u(i,r.children),i===n?n=n.nextSibling:T(e,i,n);else if(n)if(o)T(e,d(r),n);else for(;;){if(!n){E(e,d(r));break}if(!C(t,n)){y(n,r)?(s(n,r.attrs),u(n,r.children),n=n.nextSibling):T(e,d(r),n);break}n=n.nextSibling}else E(e,d(r));return n},f=function(t,e){var r=[];e.filter(function(e){return e&&e.attrs&&e.attrs.domkey}).forEach(function(e){r.push(e.attrs.domkey)});var o=Object.create(null);return O(t,function(e){var n=A(e);n&&(0<=r.indexOf(n)?o[n]=e:k(t,e))}),o},a=function(n,t){e(t).forEach(function(e){k(n,t[e])})},l=function(e,n){S(e.childNodes.length-n.length,function(){k(e,e.lastChild)})},d=function(e){var n=document.createElement(e.name);return s(n,e.attrs),u(n,e.children),n},s=function(n,t){r(n,t),e(t).forEach(function(e){o(n,e,t[e])}),h(n,t)},r=function(t,r){n.call(t.attributes).forEach(function(e){var n=e.name;Object.prototype.hasOwnProperty.call(r,n)&&null!=r[n]||b(t,n)})},o=function(e,n,t){var r=typeof t;"style"===n?m(e,n,t):n in e?(N(e,n,t),"boolean"==r&&v(e,n,t)):("function"==r||"o"===n[0]&&"n"===n[1]?N:"boolean"==r?v:m)(e,n,t)},h=function(e,n){var t=e.nodeName,r=null==n.value?"":""+n.value,o=!!n.checked,i=!!n.selected;"INPUT"===t?(N(e,"checked",o),v(e,"checked",o),N(e,"value",r),m(e,"value",n.value)):"TEXTAREA"===t?N(e,"value",r):"OPTION"===t&&(N(e,"selected",i),v(e,"selected",i))},m=function(e,n,t){null==t?b(e,n):t!==e.getAttribute(n)&&e.setAttribute(n,t)},v=function(e,n,t){!0!==t||e.hasAttribute(n)?!1===t&&b(e,n):e.setAttribute(n,"")},b=function(e,n){e.hasAttribute(n)&&e.removeAttribute(n)},p=function(e){return e&&e.name&&e.attrs&&e.children},y=function(e,n){return 1===e.nodeType&&e.nodeName.toLowerCase()===n.name.toLowerCase()},A=function(e){return 1===e.nodeType?e.getAttribute("domkey"):null},g=function(e){for(var n=e.lastChild;n;n=e.lastChild)k(e,n)},E=function(e,n){e.appendChild(n)},T=function(e,n,t){e.insertBefore(n,t)},k=function(e,n){e.removeChild(n)},x=function(e){return document.createTextNode(e)},C=function(n,t){return null!=n&&e(n).some(function(e){return n[e]===t})},N=function(e,n,t){t!==e[n]&&(e[n]=t)},O=function(e,n){for(var t=e.firstChild;t;){var r=t.nextSibling;n(t),t=r}},S=function(e,n){for(var t=0;t<e;t+=1)n(t)};return function(e,n){t(n)?u(e,n):null!=n?u(e,[n]):g(e)}});
