!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.patch2dom=t()}(this,function(){"use strict";var s=1,d=3,n=Array.isArray;function c(l,e){var t=[];e.forEach(function(e){e&&e.attrs&&e.attrs.domkey&&t.push(e.attrs.domkey)});for(var f=Object.create(null),r=l.firstChild;r;r=r.nextSibling){var n=a(r);n&&(0<=t.indexOf(n)?f[n]=r:l.removeChild(r))}var u=l.firstChild;for(var i in e.forEach(function(e){var t,r,n,i=typeof e;if("string"===i||"number"===i)u?u.nodeType===d?(u.nodeValue=e,u=u.nextSibling):l.insertBefore(document.createTextNode(e),u):l.appendChild(document.createTextNode(e));else if((n=e)&&n.name&&n.attrs&&n.children){var o=e.attrs.domkey,a=o?f[o]:null;if(a)delete f[o],a===u?u=u.nextSibling:l.insertBefore(a,u),h(a,e.attrs),c(a,e.children);else if(u)if(o)l.insertBefore(m(e),u);else for(;;){if(!u){l.appendChild(m(e));break}if(!v(f,u)){r=e,(t=u).nodeType===s&&t.nodeName.toLowerCase()===r.name.toLowerCase()?(h(u,e.attrs),c(u,e.children),u=u.nextSibling):l.insertBefore(m(e),u);break}u=u.nextSibling}else l.appendChild(m(e))}}),f)l.removeChild(f[i]);for(var o=l.childNodes.length-e.length;0<=--o;)l.removeChild(l.lastChild)}function m(e){var t=document.createElement(e.name);return h(t,e.attrs),c(t,e.children),t}function h(n,i){for(var e=n.attributes,t=e.length-1;0<=t;t-=1){var r=e[t].name;i.hasOwnProperty(r)&&null!=i[r]||n.removeAttribute(r)}Object.getOwnPropertyNames(i).forEach(function(e){var t=i[e],r=typeof t;"style"===e?(n.style.cssText=t)?n.setAttribute(e,t):n.removeAttribute(e):e in n?(!0===(n[e]=t)?n.setAttribute(e.toLowerCase(),""):!1===t&&n.removeAttribute(e.toLowerCase()),"value"===e&&(null==t?n.removeAttribute(e):n.setAttribute(e,t))):"function"===r||"o"===e[0]&&"n"===e[1]?n[e]=t:"boolean"===r?!0===t?n.setAttribute(e,""):n.removeAttribute(e):null==t?n.removeAttribute(e):n.setAttribute(e,t)})}function a(e){if(e.nodeType===s)return e.getAttribute("domkey")}function v(e,t){for(var r in e)if(e[r]===t)return!0;return!1}return function(e,t){if(n(t))c(e,t);else if(null!=t)c(e,[t]);else for(var r=e.lastChild;r;)e.removeChild(r)}});
