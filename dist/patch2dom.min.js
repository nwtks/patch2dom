!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.patch2dom=t()}(this,function(){"use strict";var f=1,u=3,n=Array.isArray;function l(r,e){if("TEXTAREA"!==r.nodeName){var i=function(e,t){var n=[];t.forEach(function(e){e&&e.attrs&&e.attrs.domkey&&n.push(e.attrs.domkey)});for(var r=Object.create(null),i=e.firstChild;i;i=i.nextSibling){var o=a(i);o&&(0<=n.indexOf(o)?r[o]=i:y(e,i))}return r}(r,e),o=r.firstChild;e.forEach(function(e){var t,n=typeof e;"string"===n||"number"===n?o=function(e,t,n){t?t.nodeType===u?(t.nodeValue!==n&&(t.nodeValue=n),t=t.nextSibling):b(e,p(n),t):m(e,p(n));return t}(r,o,""+e):(t=e)&&t.name&&t.attrs&&t.children&&(o=function(e,t,n,r){var i=r.attrs.domkey,o=i?n[i]:null;if(o)delete n[i],d(o,r.attrs),l(o,r.children),o===t?t=t.nextSibling:b(e,o,t);else if(t)if(i)b(e,c(r),t);else for(;;){if(!t){m(e,c(r));break}if(!A(n,t)){a=r,(u=t).nodeType===f&&u.nodeName.toLowerCase()===a.name.toLowerCase()?(d(t,r.attrs),l(t,r.children),t=t.nextSibling):b(e,c(r),t);break}t=t.nextSibling}else m(e,c(r));var u,a;return t}(r,o,i,e))}),function(e,t){for(var n in t)y(e,t[n])}(r,i),function(e,t){for(var n=e.childNodes.length-t.length;0<n;--n)y(e,e.lastChild)}(r,e)}}function c(e){var t=document.createElement(e.name);return d(t,e.attrs),l(t,e.children),t}function d(o,u){var e,t,n,r,i,a;!function(e,t){for(var n=e.attributes,r=n.length-1;0<=r;--r){var i=n[r],o=i.name;t.hasOwnProperty(o)&&null!=t[o]||v(e,o)}}(o,u),Object.getOwnPropertyNames(u).forEach(function(e){return t=o,r=u[n=e],i=typeof r,void("style"===n?s(t,n,r):n in t?(g(t,n,r),"boolean"===i&&h(t,n.toLowerCase(),r)):"function"===i||"o"===n[0]&&"n"===n[1]?g(t,n,r):"boolean"===i?h(t,n,r):s(t,n,r));var t,n,r,i}),t=u,n=(e=o).nodeName,r=null==t.value?"":""+t.value,i=!!t.checked,a=!!t.selected,"INPUT"===n?(g(e,"checked",i),h(e,"checked",i),g(e,"value",r),s(e,"value",t.value)):"TEXTAREA"===n?g(e,"value",r):"OPTION"===n&&(g(e,"selected",a),h(e,"selected",a))}function s(e,t,n){null==n?v(e,t):n!==e.getAttribute(t)&&e.setAttribute(t,n)}function h(e,t,n){!0!==n||e.hasAttribute(t)?!1===n&&v(e,t):e.setAttribute(t,"")}function v(e,t){e.hasAttribute(t)&&e.removeAttribute(t)}function a(e){if(e.nodeType===f)return e.getAttribute("domkey")}function m(e,t){e.appendChild(t)}function b(e,t,n){e.insertBefore(t,n)}function y(e,t){e.removeChild(t)}function p(e){return document.createTextNode(e)}function A(e,t){for(var n in e)if(e[n]===t)return!0;return!1}function g(e,t,n){n!==e[t]&&(e[t]=n)}return function(e,t){n(t)?l(e,t):null!=t?l(e,[t]):function(e){for(var t=e.lastChild;t;t=e.lastChild)y(e,t)}(e)}});
