!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.patch2dom=n()}(this,function(){"use strict";var f=1,u=3,t=Array.isArray;function c(r,e){if("TEXTAREA"!==r.nodeName){var o=function(e,n){var t=[];n.forEach(function(e){e&&e.attrs&&e.attrs.domkey&&t.push(e.attrs.domkey)});for(var r=Object.create(null),o=e.firstChild;o;o=o.nextSibling){var i=a(o);i&&(0<=t.indexOf(i)?r[i]=o:b(e,o))}return r}(r,e),i=r.firstChild;e.forEach(function(e){var n,t=typeof e;"string"===t||"number"===t?i=function(e,n,t){n?n.nodeType===u?(n.nodeValue!==t&&(n.nodeValue=t),n=n.nextSibling):m(e,y(t),n):h(e,y(t));return n}(r,i,""+e):(n=e)&&n.name&&n.attrs&&n.children&&(i=function(e,n,t,r){var o=r.attrs.domkey,i=o?t[o]:null;if(i)delete t[o],d(i,r.attrs),c(i,r.children),i===n?n=n.nextSibling:m(e,i,n);else if(n)if(o)m(e,l(r),n);else for(;;){if(!n){h(e,l(r));break}if(!g(t,n)){a=r,(u=n).nodeType===f&&u.nodeName.toLowerCase()===a.name.toLowerCase()?(d(n,r.attrs),c(n,r.children),n=n.nextSibling):m(e,l(r),n);break}n=n.nextSibling}else h(e,l(r));var u,a;return n}(r,i,o,e))}),function(e,n){for(var t in n)b(e,n[t])}(r,o),function(e,n){for(var t=e.childNodes.length-n.length;0<t;--t)b(e,e.lastChild)}(r,e)}}function l(e){var n=document.createElement(e.name);return d(n,e.attrs),c(n,e.children),n}function d(i,u){var e,n,t,r,o,a;!function(e,n){for(var t=e.attributes,r=t.length-1;0<=r;--r){var o=t[r],i=o.name;n.hasOwnProperty(i)&&null!=n[i]||p(e,i)}}(i,u),Object.getOwnPropertyNames(u).forEach(function(e){return n=i,r=u[t=e],o=typeof r,void("style"===t?s(n,t,r):t in n?(A(n,t,r),v(n,t.toLowerCase(),r)):"function"===o||"o"===t[0]&&"n"===t[1]?A(n,t,r):"boolean"===o?v(n,t,r):s(n,t,r));var n,t,r,o}),n=u,t=(e=i).nodeName,r=null==n.value?"":""+n.value,o=!!n.checked,a=!!n.selected,"INPUT"===t?(A(e,"checked",o),v(e,"checked",o),A(e,"value",r),s(e,"value",n.value)):"TEXTAREA"===t?A(e,"value",r):"OPTION"===t&&(A(e,"selected",a),v(e,"selected",a))}function s(e,n,t){null==t?p(e,n):t!==e.getAttribute(n)&&e.setAttribute(n,t)}function v(e,n,t){!0===t?s(e,n,""):!1===t&&p(e,n)}function a(e){if(e.nodeType===f)return e.getAttribute("domkey")}function h(e,n){e.appendChild(n)}function m(e,n,t){e.insertBefore(n,t)}function b(e,n){e.removeChild(n)}function y(e){return document.createTextNode(e)}function p(e,n){e.removeAttribute(n)}function g(e,n){for(var t in e)if(e[t]===n)return!0;return!1}function A(e,n,t){t!==e[n]&&(e[n]=t)}return function(e,n){t(n)?c(e,n):null!=n?c(e,[n]):function(e){for(var n=e.lastChild;n;n=e.lastChild)b(e,n)}(e)}});
