!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.patch2dom=t()}(this,function(){"use strict";var d=1,s=3,n=Array.isArray;function c(f,e){var t=[];e.forEach(function(e){e&&e.attrs&&e.attrs.domkey&&t.push(e.attrs.domkey)});for(var l=Object.create(null),r=f.firstChild;r;r=r.nextSibling){var n=a(r);n&&(0<=t.indexOf(n)?l[n]=r:f.removeChild(r))}var u=f.firstChild;for(var o in e.forEach(function(e){var t,r,n,o=typeof e;if("string"===o||"number"===o)u?u.nodeType===s?(u.nodeValue=e,u=u.nextSibling):f.insertBefore(document.createTextNode(e),u):f.appendChild(document.createTextNode(e));else if((n=e)&&Object.getPrototypeOf(n)===Object.prototype){var i=e.attrs.domkey,a=i?l[i]:null;if(a)delete l[i],a===u?u=u.nextSibling:f.insertBefore(a,u),b(a,e.attrs),c(a,e.children);else if(u)if(i)f.insertBefore(m(e),u);else for(;;){if(!u){f.appendChild(m(e));break}if(!h(l,u)){r=e,(t=u).nodeType===d&&t.nodeName.toLowerCase()===r.name.toLowerCase()?(b(u,e.attrs),c(u,e.children),u=u.nextSibling):f.insertBefore(m(e),u);break}u=u.nextSibling}else f.appendChild(m(e))}}),l)f.removeChild(l[o]);for(var i=f.childNodes.length-e.length;0<=--i;)f.removeChild(f.lastChild)}function m(e){var t=document.createElement(e.name);return b(t,e.attrs),c(t,e.children),t}function b(n,o){for(var e=n.attributes,t=e.length-1;0<=t;t-=1){var r=e[t].name;o.hasOwnProperty(r)&&null!=o[r]||n.removeAttribute(r)}Object.getOwnPropertyNames(o).forEach(function(e){var t=o[e],r=typeof t;e in n?(!0===(n[e]=t)?n.setAttribute(e.toLowerCase(),""):!1===t&&n.removeAttribute(e.toLowerCase()),"value"===e&&(null==t?n.removeAttribute(e):n.setAttribute(e,t))):"function"===r||"o"===e[0]&&"n"===e[1]?n[e]=t:"boolean"===r?!0===t?n.setAttribute(e,""):n.removeAttribute(e):null==t?n.removeAttribute(e):n.setAttribute(e,t)})}function a(e){if(e.nodeType===d)return e.getAttribute("domkey")}function h(e,t){for(var r in e)if(e[r]===t)return!0;return!1}return function(e,t){if(n(t))c(e,t);else if(null!=t)c(e,[t]);else for(var r=e.lastChild;r;)e.removeChild(r)}});
