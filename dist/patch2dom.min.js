!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.patch2dom=t()}(this,function(){"use strict";var s=1,c=3,n=Array.isArray;function m(f,e){var t=[];e.forEach(function(e){e&&e.attrs&&e.attrs.domkey&&t.push(e.attrs.domkey)});for(var u=Object.create(null),r=f.firstChild;r;r=r.nextSibling){var n=a(r);n&&(0<=t.indexOf(n)?u[n]=r:f.removeChild(r))}var d=f.firstChild;for(var i in e.forEach(function(e){var t,r,n,i=typeof e;if("string"===i||"number"===i)if(d)if(d.nodeType===c){var o=""+e;d.nodeValue!==o&&(d.nodeValue=o),d=d.nextSibling}else f.insertBefore(document.createTextNode(e),d);else f.appendChild(document.createTextNode(e));else if((n=e)&&n.name&&n.attrs&&n.children){var a=e.attrs.domkey,l=a?u[a]:null;if(l)delete u[a],l===d?d=d.nextSibling:f.insertBefore(l,d),h(l,e.attrs),m(l,e.children);else if(d)if(a)f.insertBefore(v(e),d);else for(;;){if(!d){f.appendChild(v(e));break}if(!b(u,d)){r=e,(t=d).nodeType===s&&t.nodeName.toLowerCase()===r.name.toLowerCase()?(h(d,e.attrs),m(d,e.children),d=d.nextSibling):f.insertBefore(v(e),d);break}d=d.nextSibling}else f.appendChild(v(e))}}),u)f.removeChild(u[i]);for(var o=f.childNodes.length-e.length;0<=--o;)f.removeChild(f.lastChild)}function v(e){var t=document.createElement(e.name);return h(t,e.attrs),m(t,e.children),t}function h(n,i){for(var e=n.attributes,t=e.length-1;0<=t;t-=1){var r=e[t].name;i.hasOwnProperty(r)&&null!=i[r]||n.removeAttribute(r)}Object.getOwnPropertyNames(i).forEach(function(e){var t=i[e],r=typeof t;"style"===e?null==t?n.removeAttribute(e):n.setAttribute(e,t):e in n?(!0===(n[e]=t)?n.setAttribute(e.toLowerCase(),""):!1===t&&n.removeAttribute(e.toLowerCase()),"value"===e&&(null==t?n.removeAttribute(e):n.setAttribute(e,t))):"function"===r||"o"===e[0]&&"n"===e[1]?n[e]=t:"boolean"===r?!0===t?n.setAttribute(e,""):n.removeAttribute(e):null==t?n.removeAttribute(e):n.setAttribute(e,t)})}function a(e){if(e.nodeType===s)return e.getAttribute("domkey")}function b(e,t){for(var r in e)if(e[r]===t)return!0;return!1}return function(e,t){if(n(t))m(e,t);else if(null!=t)m(e,[t]);else for(var r=e.lastChild;r;)e.removeChild(r)}});
