!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.patch2dom=n()}(this,function(){"use strict";var t=Array.isArray,e=Object.getOwnPropertyNames,o=function(t,e){if("TEXTAREA"!==t.nodeName){var r=n(t,e),u=t.firstChild;e.forEach(function(e){var n=typeof e;"string"===n||"number"===n?u=i(t,u,""+e):b(e)&&(u=c(t,u,r,e))}),l(t,r),d(t,e)}},i=function(e,n,t){return n?3===n.nodeType?(n.nodeValue!==t&&(n.nodeValue=t),n=n.nextSibling):T(e,x(t),n):g(e,x(t)),n},c=function(e,n,t,r){var u=r.attrs.domkey,i=u?t[u]:null;if(i)delete t[u],a(i,r.attrs),o(i,r.children),i===n?n=n.nextSibling:T(e,i,n);else if(n)if(u)T(e,f(r),n);else for(;;){if(!n){g(e,f(r));break}if(!C(t,n)){y(n,r)?(a(n,r.attrs),o(n,r.children),n=n.nextSibling):T(e,f(r),n);break}n=n.nextSibling}else g(e,f(r));return n},f=function(e){var n=document.createElement(e.name);return a(n,e.attrs),o(n,e.children),n},a=function(n,t){s(n,t),e(t).forEach(function(e){return r(n,e,t[e])}),u(n,t)},n=function(e,n){var t=[];n.filter(function(e){return e&&e.attrs&&e.attrs.domkey}).forEach(function(e){t.push(e.attrs.domkey)});for(var r=Object.create(null),u=e.firstChild;u;u=u.nextSibling){var i=p(u);i&&(0<=t.indexOf(i)?r[i]=u:k(e,u))}return r},l=function(n,t){return e(t).forEach(function(e){return k(n,t[e])})},d=function(e,n){for(var t=e.childNodes.length-n.length;0<t;t-=1)k(e,e.lastChild)},r=function(e,n,t){var r=typeof t;"style"===n?h(e,n,t):n in e?(E(e,n,t),"boolean"===r&&m(e,n,t)):"function"===r||"o"===n[0]&&"n"===n[1]?E(e,n,t):"boolean"===r?m(e,n,t):h(e,n,t)},u=function(e,n){var t=e.nodeName,r=null==n.value?"":""+n.value,u=!!n.checked,i=!!n.selected;"INPUT"===t?(E(e,"checked",u),m(e,"checked",u),E(e,"value",r),h(e,"value",n.value)):"TEXTAREA"===t?E(e,"value",r):"OPTION"===t&&(E(e,"selected",i),m(e,"selected",i))},s=function(e,n){for(var t=e.attributes,r=t.length-1;0<=r;r-=1){var u=t[r].name;n.hasOwnProperty(u)&&null!=n[u]||v(e,u)}},h=function(e,n,t){null==t?v(e,n):t!==e.getAttribute(n)&&e.setAttribute(n,t)},m=function(e,n,t){!0!==t||e.hasAttribute(n)?!1===t&&v(e,n):e.setAttribute(n,"")},v=function(e,n){e.hasAttribute(n)&&e.removeAttribute(n)},b=function(e){return e&&e.name&&e.attrs&&e.children},y=function(e,n){return 1===e.nodeType&&e.nodeName.toLowerCase()===n.name.toLowerCase()},p=function(e){return 1===e.nodeType?e.getAttribute("domkey"):null},A=function(e){for(var n=e.lastChild;n;n=e.lastChild)k(e,n)},g=function(e,n){return e.appendChild(n)},T=function(e,n,t){return e.insertBefore(n,t)},k=function(e,n){return e.removeChild(n)},x=function(e){return document.createTextNode(e)},C=function(t,r){return null!=t&&e(t).reduce(function(e,n){return t[n]===r||e},!1)},E=function(e,n,t){t!==e[n]&&(e[n]=t)};return function(e,n){t(n)?o(e,n):null!=n?o(e,[n]):A(e)}});
